<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Layout</title>
    <link rel="stylesheet" href="./assets/css/iconfont/icofont.css" >
    <link rel="stylesheet" href="./styles.css" >
    
    <script>
        function send(){
            const elemento = document.getElementById("form_pessoa");
            const formData = new FormData(elemento);
           console.log("Clique",formData);
            
        }

        async function get(){
            let data;
            const response = await fetch("http://localhost:81/pessoa/show/0", {
                method: "GET",
                headers: {
                    "Content-Type": "Authorization",
                    "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NjIyNzYwNTIsImV4cCI6MTc2MjI3OTY1Miwic3ViIjoxLCJuYW1lIjoiUm9ic29uIEpvbmUifQ.yIEp4QO32yn9m1wBaYzeHBKfMYPsCwNRokFrb3oy6Uc",
                }
            }
            ).then(response => response.json())
            .then((json) => data = json[0]);

            console.log(data.id);

            console.log(data);
            
            const inputs = Array.from(document.querySelectorAll('input.input,select.input'));
            inputs.map((input,index)=>{
                input.value = data[input.name];
            });
            

            const profileData = Array.from(document.querySelectorAll('.profile-data'));
            console.log(profileData[0].children);
           let elements = Array.from(profileData[0].children);
           elements.map(item =>{
               let value = item.innerText;
               item.innerText = data[value.replace(/[{}]/g, "")]?data[value.replace(/[{}]/g, "")]:value;
               //profileData.innerText = data.nome;

           })
        }

    </script>
</head>
<body>
    <div class="main">
        <div class="content">
            <div class="sidebar"></div>
            <div class="container">
                <div class="navbar">
                    <div class="title">Gestão de Pessoa</div> 
                </div>
                <div class="panel">
                    <div class="panel-title">
                        Profile
                    </div>
                    <div class="panel-body flex-center">
                        <div class="row cel-16 xs">
                            <div class="toolbar cel-24">
                                <div class="tool-title">Profile</div>
                                <div class="tool-action">
                                    <div class="item-tool" onClick="send()"><i class="icofont icofont-save"></i></div>
                                    <div class="item-tool"><i class="icofont icofont-file-file"></i></div>
                                    <div class="item-tool" onClick="get()"><i class="icofont icofont-edit"></i></div>
                                    <div class="item-tool"><i class="icofont icofont-spreadsheet"></i></div>
                                    <div class="item-tool"><i class="icofont icofont-print"></i></div>
                                    <div class="item-tool"><i class="icofont icofont-ban"></i></div>                                 
                                </div>
                            </div>
                            <div class="profile cel-4 xs">
                                <img src="https://randomuser.me/api/portraits/men/35.jpg" />
                                <div class="profile-data">
                                    <p class="profile-name">{{nome}}</p>
                                    <p class="profile-info">{{dtnascto}}</p>
                                    <p class="profile-info">ID: 1138</p>                                    
                                    <p class="profile-info">(41) 3200-6546</p>
                                </div>
                            </div>
                            <form id="form_pessoa" class="cel-20 xs">
                                <fieldset>
                                    <legend class="none">Dados Pessoais</legend>
                                </fieldset>
                                    <div class="row input-lg">
                                        <div class="item item2 cel-24 xs">
                                            <div class="component cel-16 xs">
                                                <label for="nome">Nome</label>
                                                <input class="input" type="text" id=nome" name="nome" required />
                                            </div>
                                            <div class="component cel-8 xs">
                                                <label>Nome Social</label>
                                                <input class="input" type="text" name="nome_social" required/>
                                            </div>
                                        </div>
                                    </div>
                
                                    <div class="item item2 cel-24">
                                        <div class="component cel-12">
                                            <label>Nome Pai</label>
                                            <input class="input" type="text" name="nome_pai"/>
                                        </div>
                                        <div class="component cel-12">
                                            <label>Nome Mãe</label>
                                            <input class="input" type="text" name="nome_mae" required/>
                                        </div>
                                        
                                    </div>
                                    
                                    <div class="item item2 cel-24">  
                                        <div class="component cel-4">
                                            <label>Data Nascimento</label>
                                            <input class="input" type="date" name="dtnascto" required/>
                                        </div>
                                        <div class="component cel-4">
                                            <label>Data Obito</label>
                                            <input class="input" type="date" name="datobito"/>
                                        </div>
                                        <div class="component cel-4">
                                            <label>Sexo</label>
                                            <div class="check_group">
                                                <input class="input" type="radio" name="sexo" value = "M" required/> <label for="sexo" class="m-0 label_check">Masculino</label>
                                                <input class="input" type="radio" name="sexo" value = "F" required/> <label for="sexo" class="m-0 label_check">Feminino</label>
                                            </div>
                                        </div>
                                        <div class="component cel-4">
                                            <label>Raça</label>
                                            <select class="input" name="id_racacor" required/>
                                                <option>Selecione</option>
                                                <option value = 4>Amarela</option>
                                                <option value = 1>Branca</option>
                                                <option value = 5>Indígena</option>
                                                <option value = 6>Não informado</option>
                                                <option value = 3>Parda</option>
                                                <option value = 2>Preta</option>
                                            </select>
                                        </div>
                                
                                        <div class="component cel-4">
                                            <label>Estado Civil</label>
                                            <select class="input" name="id_estado_civil" required/>
                                                <option>Selecione</option>
                                                <option value = 2>Casado</option>
                                                <option value = 3>Divorciado</option>
                                                <option value = 4>Separado</option>
                                                <option value = 1>Solteiro</option>
                                                <option value = 5>Viúvo</option>
                                            </select>
                                        </div>
                                        <!--div class="component cel-2">
                                            <label for="nome">CPF</label>
                                            <input class="input" type="text" id=nome" name="nome" />
                                        </div>
                                        <div class="component cel-2">
                                            <label>RG</label>
                                            <input class="input" type="text" name="" required/>
                                        </div>
                                        <div class="component cel-1">
                                            <label>UF-RG</label>
                                            <input class="input" type="text" name="" required/>
                                        </div-->
                                        
                                    </div>
                                    <div class="item item2 cel-24">  
                                        <div class="component cel-6">
                                            <label>País Nascimento</label>
                                            <select class="input" name="id_pais_nascimento" required/>
                                            <option>Selecione</option>
                                                <option value = 105>Brasil</option>
                                            </select>
                                        </div>
                                        <div class="component cel-6">
                                            <label>UF Nascimento</label>
                                            <select class="input" name="uf_nascimento" required/>
                                                <option>Selecione</option>
                                                <option value = "AC">Acre (AC)</option>
                                                <option value = "AL">Alagoas (AL)</option>
                                                <option value = "AP">Amapá (AP)</option>
                                                <option value = "AM">Amazonas (AM)</option>
                                                <option value = "BA">Bahia (BA)</option>
                                                <option value = "CE">Ceará (CE)</option>
                                                <option value = "DF">Distrito Federal (DF)</option>
                                                <option value = "ES">Espírito Santo (ES)</option>
                                                <option value = "GO">Goiás (GO)</option>
                                                <option value = "MA">Maranhão (MA)</option>
                                                <option value = "MT">Mato Grosso (MT)</option>
                                                <option value = "MS">Mato Grosso do Sul (MS)</option>
                                                <option value = "MG">Minas Gerais (MG)</option>
                                                <option value = "PA">Pará (PA)</option>
                                                <option value = "PB">Paraíba (PB)</option>
                                                <option value = "PR">Paraná (PR)</option>
                                                <option value = "PE">Pernambuco (PE)</option>
                                                <option value = "PI">Piauí (PI)</option>
                                                <option value = "RJ">Rio de Janeiro (RJ)</option>
                                                <option value = "RN">Rio Grande do Norte (RN)</option>
                                                <option value = "RS">Rio Grande do Sul (RS)</option>
                                                <option value = "RO">Rondônia (RO)</option>
                                                <option value = "RR">Roraima (RR)</option>
                                                <option value = "SC">Santa Catarina (SC)</option>
                                                <option value = "SP">São Paulo (SP)</option>
                                                <option value = "SE">Sergipe (SE)</option>
                                                <option value = "TO">Tocantins (TO)</option>
                                            </select>
                                        </div>
                                        <div class="component cel-6">
                                            <label>Cidade Nascimento</label>
                                            <select class="input" name="cidade_nascimento" required/>
                                            <option>Selecione</option>
                                                <option>Casado</option>
                                                <option>Solteiro</option>
                                                <option>Viúvo</option>
                                            </select>
                                        </div>
                                        <div class="component cel-6">
                                            <label>País Nacionalidade</label>
                                            <select class="input" name="id_pais_nacionalidade" required/>
                                            <option>Selecione</option>
                                                <option>Casado</option>
                                                <option>Solteiro</option>
                                                <option>Viúvo</option>
                                            </select>
                                        </div>
                                    </div>
                                    <br/>
                                    <br/>
                                    <div class="item item2 cel-24">
                                        <div class="component cel-4">
                                            <label>Data Atualização</label>
                                            <input class="input" type="datetime-local" value = "09/09/2025 09:38"id="ultimaAtualizacao" placeholder="dd/mm/yyyy hh24:mi:ss" name="data_atualizacao" readonly/>
                                        </div>
                                        <div class="component cel-6">
                                            <label>Usuário</label>
                                            <input class="input" type="text" name="id_usuario" readonly/>
                                        </div>
                                        <div class="component cel-4">
                                            <label>Perfil</label>
                                            <input class="input" type="text" name="id_perfil" readonly/>
                                        </div>
                                        
                                        <!--div class="component cel-6" style="justify-content: flex-end;flex-direction: row;gap:.5rem;">
                                            <button  class="danger" onClick="send()" style="align-self: end">Cancelar</button>
                                            <input class="input" class="primary" type="submit" form="form_pessoa" value="Enviar" onClick="send()" style="align-self: end"/>
                                        </div-->
                                    </div>
                                           
                               
                            </form>
                        </div>
                        <div class="row flex-column cel-16">
                            <div class="panel cel-24 mt-1">
                                <div class="panel-title mini">
                                    <i class="icofont icofont-table"></i>
                                    Histórico de Alterações</div>
                                <div class="panel-body">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>Data</th>
                                                <th>Operação</th>
                                                <th>Usuário</th>
                                                <th>Nome</th>
                                                <th>Nome Pai</th>
                                                <th>Nome Mãe</th>
                                                <th>Nascimento</th>
                                                <th>Óbito</th>
                                                <th>Sexo</th>
                                                <th>Raça</th>
                                                <th>Esado Civil</th>
                                                <th>País / UF / Cidade Nascimento</th>
                                                <th>Nacionalidade</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>2</td>
                                                <td>04/09/2025 11:53:33</td>
                                                <td>ALT</td>
                                                <td>MASTER</td>
                                                <td>ROBSON JONE GOMES</td>
                                                <td>NÃO DECLARADO</td>
                                                <td>SINDIA TEODORO GOMES</td>
                                                <td>14/08/1985</td>
                                                <td></td>
                                                <td>Masculino</td>
                                                <td>Branca</td>
                                                <td>Casado</td>
                                                <td>Brasil/PR/Umuarama</td>
                                                <td>Brasil</td>
                                            </tr>
                                            <tr>
                                                <td>1</td>
                                                <td>01/09/2025 08:21:12</td>
                                                <td>INS</td>
                                                <td>MASTER</td>
                                                <td>ROBSON JONE GOMES</td>
                                                <td>NÃO DECLARADO</td>
                                                <td>SINDIA TEODORO GOMES</td>
                                                <td>14/08/1985</td>
                                                <td></td>
                                                <td>Masculino</td>
                                                <td>Branca</td>
                                                <td>Solteiro</td>
                                                <td>Brasil/PR/Umuarama</td>
                                                <td>Brasil</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="cel-6">
                                Div 6 
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer">
                    </div>
                </div>

                <div class="panel" ">
                    <div class="panel-title">
                        Profile
                    </div>
                    <div class="panel-body flex-center">
                        <div class="layout">
                            <div class="resize">resize1</div>
                            <div class="resize">resize2</div>
                            <div class="resize">resize3</div>
                            <div class="resize">resize4</div>
                            <div id="table" class="resize" onclick="duplicate()">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Data</th>
                                            <th>Operação</th>
                                            <th>Usuário</th>
                                            <th>Nome</th>
                                            <th>Nome Pai</th>
                                            <th>Nome Mãe</th>
                                            <th>Nascimento</th>
                                            <th>Óbito</th>
                                            <th>Sexo</th>
                                            <th>Raça</th>
                                            <th>Esado Civil</th>
                                            <th>País / UF / Cidade Nascimento</th>
                                            <th>Nacionalidade</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>2</td>
                                            <td>04/09/2025 11:53:33</td>
                                            <td>ALT</td>
                                            <td>MASTER</td>
                                            <td>ROBSON JONE GOMES</td>
                                            <td>NÃO DECLARADO</td>
                                            <td>SINDIA TEODORO GOMES</td>
                                            <td>14/08/1985</td>
                                            <td></td>
                                            <td>Masculino</td>
                                            <td>Branca</td>
                                            <td>Casado</td>
                                            <td>Brasil/PR/Umuarama</td>
                                            <td>Brasil</td>
                                        </tr>
                                        <tr>
                                            <td>1</td>
                                            <td>01/09/2025 08:21:12</td>
                                            <td>INS</td>
                                            <td>MASTER</td>
                                            <td>ROBSON JONE GOMES</td>
                                            <td>NÃO DECLARADO</td>
                                            <td>SINDIA TEODORO GOMES</td>
                                            <td>14/08/1985</td>
                                            <td></td>
                                            <td>Masculino</td>
                                            <td>Branca</td>
                                            <td>Solteiro</td>
                                            <td>Brasil/PR/Umuarama</td>
                                            <td>Brasil</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="resize" id="draggableDiv"> Div</div>
                        </div>
                        <div class="profile cel-20" style="display: none;">
                            <div class="profile-banner">
                                
                            </div>
                            <div class="profile-header">
                                <img src="./assets/img/profile (5).jpg" height="200"/>
                                <div class="profile-name">John Doe</div>
                            </div>
                        </div>                            
                    </div>
                </div>
            </div>

        </div>
    </div>
    <script>
        const atualizacao = document.getElementById("ultimaAtualizacao");
        let data = new Date();
        //atualizacao.value = data.toLocaleDateString()+" "+data.toLocaleTimeString();
    </script>
    <script>
        const draggableDiv = document.getElementById('draggableDiv');
        let isDragging = false;
        let offsetX, offsetY; // To store the offset from the div's top-left to the mouse pointer

        draggableDiv.addEventListener('mousedown', (e) => {
            isDragging = true;
            draggableDiv.style.cursor = 'grabbing';

            // Calculate the offset from the div's top-left corner to the mouse pointer
            offsetX = e.clientX - draggableDiv.getBoundingClientRect().left;
            offsetY = e.clientY - draggableDiv.getBoundingClientRect().top;
            console.log(draggableDiv.getBoundingClientRect().left,"  ",e.clientX,"  ",offsetX);
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;

            // Calculate new position based on mouse coordinates and stored offset
            draggableDiv.style.left = (e.clientX - offsetX) + 'px';
            draggableDiv.style.top = (e.clientY - offsetY) + 'px';
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            draggableDiv.style.cursor = 'grab';
        });

        function duplicate(){
            const element = document.querySelector("#table");
            const layout = document.querySelector(".layout");

            layout.insertAdjacentElement("beforeend",element.cloneNode(true));
        }
    </script>       

</body>
</html>